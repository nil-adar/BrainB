<!DOCTYPE html>
{% load static %}
<html lang="he">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://db.onlinewebfonts.com/c/70157cb1204ca26691b11450306cd5f4?family=Harmonia+Sans+W06+Semi+Bold+Cn"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>NODUS - Consent Form</title>

    <style>
        body.en {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            color: #0063A0;
            background-image: url("{% static 'images/background-FAQ.png' %}");
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        body.rtl {
            direction: rtl;
        }

        body.he {
            font-family: 'Assistant', sans-serif;
        }

        .rtl .header nav a {
            margin-right: 20px;
            margin-left: 0;
        }

        .rtl .logo-name {
            text-align: right;
        }

        .rtl input {
            text-align: right;
        }

        .header {
            background-color: #0f75bc;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header img {
            width: 70px;
        }

        .header nav a {
            color: white;
            margin-left: 20px;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .header nav a:hover {
            color: #16B06F;
        }

        .language-selector {
            display: flex;
            align-items: center;
            margin-left: 20px;
        }

        .language-btn {
            background-color: transparent;
            color: white;
            border: 1px solid white;
            padding: 5px 10px;
            margin: 0 5px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .language-btn:hover, .language-btn.active {
            background-color: #16B06F;
            border-color: #16B06F;
        }

        .hero {
            color: white;
            text-align: center;
            padding: 40px 20px 20px;
            min-height: 65vh;
        }

        .hero h1 {
            margin: 0px;
            font-size: 3em;
            color: #0063A0;
            font-family: inherit;
        }

        .hero h2 {
            margin: 20px;
            font-size: 2em;
            color: #0063A0;
            font-family: inherit;
        }

        .hero h3 {
            margin: 30px;
            font-size: 2em;
            color: #0063A0;
            font-family: inherit;
        }

        .hero p {
            margin: 10px;
            font-size: 1.5em;
            color: #0063A0;
            font-family: inherit;
        }

        .hero ul {
            list-style-type: decimal;
            align-items: center;
            display: grid;
            justify-items: center
        }

        .hero li {
            margin: 10px;
            font-size: 1.5em;
            color: #0063A0;
            font-family: inherit;
            text-align: center;
        }

        .hero button {
            margin: 20px;
            background-color: #01C5A2;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            cursor: pointer;
            border-radius: 5px;
            font-family: inherit;
            transition: background-color 0.3s ease;
        }

        .hero button:hover {
            background-color: #019c84;
        }

        .content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .footer {
            background-color: #0f75bc;
            color: white;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            width: 100%;
        }

        .footer div {
            flex: 1;
            min-width: 200px;
            margin: 10px;
        }

        .footer a {
            color: white;
            text-decoration: none;
            transition: text-decoration 0.3s ease;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .logo-name {
            text-align: left;
            text-decoration: none;
            align-items: center;
            color: white;
            font-size: x-large;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .logo-name:hover {
            color: #16B06F;
        }

        #signature-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 800px;
        }

        #signature-pad {
            border: 1px solid #000;
            width: 100%;
            height: 200px;
            background-color: white;
            box-sizing: border-box; /* Recommended for easier width/height management */
        }
    </style>
</head>

<body>
    <header class="header">
        <div style="justify-content: right; display: flex; text-align: center; align-items: center;">
            <img src="{% static 'images/nodus-icon-removebg-preview.png' %}" alt="NODUS Logo" sizes="50px">
            <a class="logo-name" href="#" onclick="location.href='{% url 'landing' %}'"><strong data-translate="nodus">NODUS</strong></a>
        </div>
        <div style="display: flex; align-items: center;">
            <nav style="padding: 10px;">
                <a href="#" onclick="location.href='{% url 'landing' %}'" data-translate="home">Home</a>
                <a href="#" onclick="location.href='{% url 'consent' %}'" data-translate="start_test">Start Test</a>
                <a href="#" onclick="location.href='{% url 'FAQ' %}'" data-translate="faq">FAQ</a>
            </nav>
            <div class="language-selector">
                <button class="language-btn active" onclick="changeLanguage('en')">EN</button>
                <button class="language-btn" onclick="changeLanguage('he')">注</button>
            </div>
        </div>
    </header>
    <section class="hero">
        <div class="overlay" style="width: 65%; margin: auto;">
            <h1 data-translate="informed_consent_form">Informed Consent Form</h1>
            <h2 data-translate="project_title_full">Project Title:<br> NODUS - Detection of ADHD Symptoms Using Eye-Tracking, Vocal Analysis, and Behavioral Questionnaire</h2>
        </div>
        <br>
        <div class="container">
            <div id="consent-form">
                <p><strong data-translate="project_supervisor">Project Supervisor:</strong> <span data-translate="supervisor_name">Dr. Natali Levi</span></p>
                <p><strong data-translate="project_developers">Project Developers:</strong> <span data-translate="developers_names">Safwan Halabi & Bishara Bisharat</span></p>
                <p><strong data-translate="institution">Institution:</strong> <span data-translate="institution_name">Braude - College of Engineering</span></p>

                <h3 data-translate="purpose_title">Purpose of the Study</h3>
                <p data-translate="purpose_text">The purpose of this study is to detect symptoms of ADHD using eye-tracking, vocal analysis, and a
                    behavioral questionnaire. The data collected will be used to train a deep learning model for
                    improved detection and analysis of ADHD symptoms.</p>

                <h3 data-translate="participation_title">Participation</h3>
                <p data-translate="participation_text">Your participation in this study is voluntary. You will be asked to provide data through
                    eye-tracking, vocal recordings, and answering a behavioral questionnaire. Your data will be
                    anonymized and used solely for the purposes of this research.</p>

                <h3 data-translate="procedures_title">Procedures</h3>
                <p data-translate="procedures_text">If you agree to participate, you will be asked to undergo the following procedures:</p>
                <ul>
                    <strong>
                        <li data-translate="procedure_1">Eye-tracking sessions to monitor your eye movements.</li>
                    </strong>
                    <strong>
                        <li data-translate="procedure_2">Vocal recordings to analyze speech patterns.</li>
                    </strong>
                    <strong>
                        <li data-translate="procedure_3">Completion of a behavioral questionnaire.</li>
                    </strong>
                </ul>

                <h3 data-translate="risks_title">Risks and Discomforts</h3>
                <p data-translate="risks_text">There are no known risks associated with this study beyond those encountered in daily life. Some
                    participants may experience minor discomfort during the eye-tracking sessions.</p>

                <h3 data-translate="benefits_title">Benefits</h3>
                <p data-translate="benefits_text">While there may be no direct benefits to you, your participation will contribute to research that may
                    improve the understanding and detection of ADHD symptoms.</p>

                <h3 data-translate="confidentiality_title">Confidentiality</h3>
                <p data-translate="confidentiality_text">Your data will be kept confidential. Only the research team will have access to the data. All data
                    will be anonymized before analysis. Results of the study may be published, but they will not include
                    any information that could identify you.</p>

                <h3 data-translate="compensation_title">Compensation</h3>
                <p data-translate="compensation_text">There is no compensation for participation in this study.</p>

                <h3 data-translate="withdraw_title">Right to Withdraw</h3>
                <p data-translate="withdraw_text">Your participation is voluntary, and you may withdraw from the study at any time without penalty or
                    loss of benefits to which you are otherwise entitled.<br> No data will be saved if you answer
                    "No" to the last question in the questionnaire</p>

                <h3 data-translate="contact_title">Contact Information</h3>
                <p data-translate="contact_text">If you have any questions or concerns about this study, please contact the developers at <br>
                    <strong>Safwan.Halabi@e.braude.ac.il</strong> & <strong>Bishara.Bisharat@e.braude.ac.il</strong>
                </p>

                <h3 data-translate="consent_title">Consent</h3>
                <p data-translate="consent_text">By signing below, you are indicating that you have read and understood the information provided
                    above, and you agree to participate in this study.</p>

                <div style="display: flex; justify-content: center; margin: 20px;">
                    <p><strong data-translate="full_name">Participant's Full Name:</strong></p>
                    <input id="name-field" type="text" name="participant_name" />
                </div>
                <div style="display: flex; justify-content: center; margin: 20px; align-items: center;">
                    <p><strong data-translate="signature">Participant's Signature:</strong></p>
                    <div id="signature-container">
                        <canvas id="signature-pad"></canvas>
                    </div>
                </div>
                <button id="save-signature" data-translate="save_signature">Save Signature</button>
                <button id="clear-signature" data-translate="clear_signature">Clear Signature</button>
            </div>
        </div>
    </section>
    <footer class="footer">
        <div style="text-align: center; align-items: center; padding: 20px;">
            <h3 data-translate="learn_more">Learn more about ADHD</h3>
            <p><a href="https://applications.emro.who.int/docs/EMRPUB_leaflet_2019_mnh_214_en.pdf" target="_blank" data-translate="who_adhd">World Health Organization - ADHD</a></p>
            <p><a href="https://www.cdc.gov/adhd/index.html" target="_blank" data-translate="cdc_adhd">CDC.gov - ADHD</a></p>
        </div>
        <div style="padding: 20px;">
            <h3 data-translate="contact_us">Contact Us</h3>
            <p>Safwan.Halabi@e.braude.ac.il</p>
            <p>Bishara.Bisharat@e.braude.ac.il</p>
        </div>
        <div style="padding: 20px; display: flex; align-items: center; justify-content: center; flex-direction: row;">
            <h2><strong style="font-size: 30px;" data-translate="nodus">NODUS</strong></h2>
            <img src="{% static 'images/nodus-icon-removebg-preview.png' %}" alt="NODUS Logo" sizes="50px"
                style="width: 70px;">
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Initialize sessionStorage with token and perform cleanup first
            const params = new URLSearchParams(window.location.search);
            const token = params.get("token");
            if (token) {
                sessionStorage.setItem("sessionToken", token);
                console.log(" 拽 砖专 -sessionStorage:", token);
            } else {
                console.warn("锔 拽  爪 -URL");
            }



            cleanUp(); // Call cleanUp to clear any previous session files

            // Canvas and drawing related variables
            const canvas = document.getElementById('signature-pad');
            if (!canvas) {
                console.error("Signature pad canvas not found!");
                return; // Stop script if canvas is not found
            }
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            let hasDrawn = false;

            // Language and translation variables
            const translations = {
                en: {
                    nodus: "NODUS",
                    home: "Home",
                    start_test: "Start Test",
                    faq: "FAQ",
                    informed_consent_form: "Informed Consent Form",
                    project_title_full: "Project Title:<br> NODUS - Detection of ADHD Symptoms Using Eye-Tracking, Vocal Analysis, and Behavioral Questionnaire",
                    project_supervisor: "Project Supervisor:",
                    supervisor_name: "Dr. Natali Levi",
                    project_developers: "Project Developers:",
                    developers_names: "Safwan Halabi & Bishara Bisharat",
                    institution: "Institution:",
                    institution_name: "Braude - College of Engineering",
                    purpose_title: "Purpose of the Study",
                    purpose_text: "The purpose of this study is to detect symptoms of ADHD using eye-tracking, vocal analysis, and a behavioral questionnaire. The data collected will be used to train a deep learning model for improved detection and analysis of ADHD symptoms.",
                    participation_title: "Participation",
                    participation_text: "Your participation in this study is voluntary. You will be asked to provide data through eye-tracking, vocal recordings, and answering a behavioral questionnaire. Your data will be anonymized and used solely for the purposes of this research.",
                    procedures_title: "Procedures",
                    procedures_text: "If you agree to participate, you will be asked to undergo the following procedures:",
                    procedure_1: "Eye-tracking sessions to monitor your eye movements.",
                    procedure_2: "Vocal recordings to analyze speech patterns.",
                    procedure_3: "Completion of a behavioral questionnaire.",
                    risks_title: "Risks and Discomforts",
                    risks_text: "There are no known risks associated with this study beyond those encountered in daily life. Some participants may experience minor discomfort during the eye-tracking sessions.",
                    benefits_title: "Benefits",
                    benefits_text: "While there may be no direct benefits to you, your participation will contribute to research that may improve the understanding and detection of ADHD symptoms.",
                    confidentiality_title: "Confidentiality",
                    confidentiality_text: "Your data will be kept confidential. Only the research team will have access to the data. All data will be anonymized before analysis. Results of the study may be published, but they will not include any information that could identify you.",
                    compensation_title: "Compensation",
                    compensation_text: "There is no compensation for participation in this study.",
                    withdraw_title: "Right to Withdraw",
                    withdraw_text: "Your participation is voluntary, and you may withdraw from the study at any time without penalty or loss of benefits to which you are otherwise entitled. No data will be saved if you answer \"No\" to the last question in the questionnaire.",
                    contact_title: "Contact Information",
                    contact_text: "If you have any questions or concerns about this study, please contact the developers at",
                    consent_title: "Consent",
                    consent_text: "By signing below, you are indicating that you have read and understood the information provided above, and you agree to participate in this study.",
                    full_name: "Participant's Full Name:",
                    signature: "Participant's Signature:",
                    save_signature: "Save Signature",
                    clear_signature: "Clear Signature",
                    learn_more: "Learn more about ADHD",
                    who_adhd: "World Health Organization - ADHD",
                    cdc_adhd: "CDC.gov - ADHD",
                    contact_us: "Contact Us",
                    no_signature: "No signature to save!",
                    no_name: "No name to save!",
                    incomplete_form: "Incomplete Form"
                },
                he: {
                    nodus: "住",
                    home: "祝 转",
                    start_test: "转 拽",
                    faq: "砖转 驻爪转",
                    informed_consent_form: "驻住 住 注转",
                    project_title_full: "转专转 驻专拽:<br> 住 -  转住 ADHD 爪注转 注拽 注, 转 拽 砖 转转",
                    project_supervisor: " 驻专拽:",
                    supervisor_name: "\"专  ",
                    project_developers: "驻转 驻专拽:",
                    developers_names: "住驻  砖专 砖专转",
                    institution: "住:",
                    institution_name: "专 -  住",
                    purpose_title: "专转 拽专",
                    purpose_text: "专转 拽专   转 转住 ADHD 爪注转 注拽 专 转注转 注, 转 拽 砖 转转. 转 砖住驻 砖砖    注拽 砖驻专  转 转住 ADHD.",
                    participation_title: "砖转转驻转",
                    participation_text: "砖转转驻转 拽专   转转转. 转转拽砖/ 住驻拽 转 爪注转 注拽 专 注, 拽转 拽转 注 注 砖 转转. 转 砖   砖砖  专拽 专转 拽专 .",
                    procedures_title: "",
                    procedures_text: " 转住/ 砖转转祝, 转转拽砖/ 注专 转  :",
                    procedure_1: "注拽 专 转注转 注 专 转注转 注 砖.",
                    procedure_2: "拽转 拽转 转 驻住 专.",
                    procedure_3: " 砖 转转.",
                    risks_title: "住  转",
                    risks_text: " 住 注 拽砖专 拽专  注专  驻砖  . 拽 砖转转驻 注砖 转  转 拽  注拽 专 注.",
                    benefits_title: "转专转",
                    benefits_text: "注 砖转    转专转 砖专, 砖转转驻转 转转专 拽专 砖注砖 砖驻专 转   砖 转住 ADHD.",
                    confidentiality_title: "住转",
                    confidentiality_text: "转 砖 砖专 住转. 专拽 爪转 拽专  注 砖 转.  转   驻 转. 转爪转 拽专 注砖转 转驻专住,     注 砖 转 转.",
                    compensation_title: "驻爪",
                    compensation_text: " 驻爪 注专 砖转转驻转 拽专 .",
                    withdraw_title: "转 驻专砖",
                    withdraw_text: "砖转转驻转  转转转, 转 专砖 驻专砖 拽专  注转  注砖   转  转 .  砖专 转  转注 \"\" 砖 专 砖.",
                    contact_title: "驻专 拽砖专",
                    contact_text: " 砖  砖转  砖砖转  拽专 ,  爪专 拽砖专 注 驻转 转转",
                    consent_title: "住",
                    consent_text: "转转 , 转 爪  拽专转 转 转 注 住驻拽 注, 转 住 砖转转祝 拽专 .",
                    full_name: "砖  砖 砖转转祝:",
                    signature: "转转 砖转转祝:",
                    save_signature: "砖专 转",
                    clear_signature: "拽 转",
                    learn_more: " 注 注 ADHD",
                    who_adhd: "专 专转 注 - ADHD",
                    cdc_adhd: "CDC.gov - ADHD",
                    contact_us: "爪专 拽砖专",
                    no_signature: " 转 砖专!",
                    no_name: " 砖 砖专!",
                    incomplete_form: "驻住  "
                }
            };
            let currentLanguage = 'he'; // Default language

            // --- Helper Functions ---
            function customAlert(message) {
                Swal.fire({
                    icon: 'warning',
                    title: (translations[currentLanguage] && translations[currentLanguage].incomplete_form) ? translations[currentLanguage].incomplete_form : 'Incomplete Form',
                    text: message,
                    confirmButtonText: 'OK'
                });
            }

            async function cleanUp() {
                try {
                    const response1 = await fetch('/done/', { method: 'GET' });
                    if (response1.ok) {
                        console.log("Flushed files from backend");
                    } else {
                        const data = await response1.json(); // Corrected to response1
                        const message = data.message || "Error during cleanup";
                        customAlert(message + ", try running the test again to remove your files");
                    }
                } catch (error) {
                    console.error("Error in cleanUp:", error);
                    customAlert("An error occurred during cleanup.");
                }
            }

            // --- Canvas Functions ---
            function resizeCanvas() {
                if (!canvas) return;
                const containerStyle = window.getComputedStyle(canvas.parentNode);
                const containerWidth = parseFloat(containerStyle.width);
                canvas.width = containerWidth;
                canvas.height = 200;
                ctx.strokeStyle = "#000000";
                ctx.lineWidth = 2;
            }

            function getMousePos(canvasEl, evt) {
                const rect = canvasEl.getBoundingClientRect();
                return {
                    x: evt.clientX - rect.left,
                    y: evt.clientY - rect.top
                };
            }

            function startDrawing(e) {
                isDrawing = true;
                const pos = getMousePos(canvas, e);
                ctx.beginPath();
                ctx.moveTo(pos.x, pos.y);
            }

            function draw(e) {
                if (!isDrawing) return;
                const pos = getMousePos(canvas, e);
                ctx.lineTo(pos.x, pos.y);
                ctx.stroke();
                hasDrawn = true;
            }

            function stopDrawing() {
                isDrawing = false;
                ctx.closePath();
            }

            function clearSignature() {
                if (!canvas) return;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                hasDrawn = false;
            }

            async function saveSignature() {
                if (!hasDrawn) {
                    customAlert(translations[currentLanguage].no_signature || 'No signature to save!');
                    return;
                }
                const fullNameInput = document.getElementById('name-field');
                if (!fullNameInput) {
                    customAlert("Name field not found!"); return;
                }
                const fullName = fullNameInput.value;
                if (!fullName) {
                    customAlert(translations[currentLanguage].no_name || 'No name to save!');
                    return;
                }

                const dataURL = canvas.toDataURL('image/png');
                function dataURLToBlob(dataURL) {
                    const binary = atob(dataURL.split(',')[1]);
                    const array = [];
                    for (let i = 0; i < binary.length; i++) {
                        array.push(binary.charCodeAt(i));
                    }
                    return new Blob([new Uint8Array(array)], { type: 'image/png' });
                }
                const blob = dataURLToBlob(dataURL);
                const formData = new FormData();
                formData.append('signature', blob, 'signature.png');
                formData.append('full-name', fullName);

                try {
                    const response = await fetch('/signature', {
                        method: 'POST',
                        body: formData,
                    });
                    if (response.ok) {
                        console.log("Signature uploaded successfully.");
                        const instructions = await fetch('/instructions', { method: 'GET' });
                        if (instructions.ok) {
                            window.location.href = instructions.url;
                        } else {
                            console.error('Failed to fetch instructions page. Status:', instructions.status);
                            customAlert('Failed to proceed. Please try again.');
                        }
                    } else {
                        console.error('Signature upload failed. Status:', response.status);
                         // The 201 check might need review based on your API's actual error responses
                        if (response.status === 201) {
                            console.error('Error (201) - couldnt upload details. API might consider this an error.');
                        }
                        customAlert('Error uploading signature. Please try again.');
                    }
                } catch (error) {
                    console.error('Error uploading signature:', error);
                    customAlert('An error occurred during signature upload.');
                }
            }

            // --- Language Function ---
            function changeLanguage(lang) {
                currentLanguage = lang;
                document.querySelectorAll('.language-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                const activeBtn = document.querySelector(`.language-btn[onclick="changeLanguage('${lang}')"]`);
                if (activeBtn) activeBtn.classList.add('active');

                document.documentElement.lang = lang;
                document.body.classList.remove('rtl', 'he'); // Clear previous lang classes
                if (lang === 'he') {
                    document.body.classList.add('rtl');
                    document.body.classList.add('he'); // Add 'he' for specific font
                }
                // For other languages, ensure 'he' and 'rtl' are removed if they were there

                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.getAttribute('data-translate');
                    if (translations[lang] && translations[lang][key]) {
                        element.innerHTML = translations[lang][key];
                    }
                });
            }

            // --- Initializations and Event Listeners ---
            if (canvas) {
                window.addEventListener('resize', resizeCanvas);
                resizeCanvas(); // Initialize canvas size

                // Mouse events
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);

                // Touch events
                canvas.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // Prevent scrolling on touch
                    if (e.touches.length > 0) {
                        const touch = e.touches[0];
                        const mouseEvent = new MouseEvent('mousedown', { clientX: touch.clientX, clientY: touch.clientY });
                        canvas.dispatchEvent(mouseEvent);
                    }
                }, { passive: false }); // Use passive: false if preventDefault is needed

                canvas.addEventListener('touchmove', function(e) {
                    e.preventDefault(); // Prevent scrolling on touch
                     if (e.touches.length > 0) {
                        const touch = e.touches[0];
                        const mouseEvent = new MouseEvent('mousemove', { clientX: touch.clientX, clientY: touch.clientY });
                        canvas.dispatchEvent(mouseEvent);
                    }
                }, { passive: false });

                canvas.addEventListener('touchend', function(e) {
                    // e.preventDefault(); // Often not needed for touchend if mousedown/move are handled
                    const mouseEvent = new MouseEvent('mouseup', {});
                    canvas.dispatchEvent(mouseEvent);
                }, false);
            }

            const saveBtn = document.getElementById('save-signature');
            if (saveBtn) saveBtn.addEventListener('click', saveSignature);

            const clearBtn = document.getElementById('clear-signature');
            if (clearBtn) clearBtn.addEventListener('click', clearSignature);

            // Setup language buttons (assuming they exist)
            document.querySelectorAll('.language-btn').forEach(btn => {
                const lang = btn.innerText === 'EN' ? 'en' : (btn.innerText === '注' ? 'he' : null);
                if (lang) {
                    btn.onclick = () => changeLanguage(lang); // Re-assign onclick to ensure it uses the scoped changeLanguage
                }
            });

            changeLanguage('he'); // Set initial language
        });
    </script>
</body>
</html>